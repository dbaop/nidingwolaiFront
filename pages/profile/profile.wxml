<!-- profile.wxml -->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card {{isLogin ? 'logged-in' : 'not-logged-in'}}">
    <view class="avatar-container">
      <image 
        class="avatar" 
        src="{{userInfo.avatar || '/images/avatar.png'}}"
        mode="aspectFill"
      ></image>
      <view wx:if="{{!isLogin}}" class="avatar-overlay">
        <text class="avatar-icon">ğŸ‘¤</text>
      </view>
    </view>
    <view class="user-info">
      <view class="nickname">{{userInfo.nickname || 'ç”¨æˆ·'}}</view>
      <view wx:if="{{isLogin}}" class="user-stats">
        <view class="stat-item">
          <text class="stat-number">{{userStats.joined}}</text>
          <text class="stat-label">å·²å‚åŠ </text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{userStats.created}}</text>
          <text class="stat-label">å·²åˆ›å»º</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{userStats.friends}}</text>
          <text class="stat-label">å¥½å‹</text>
        </view>
      </view>
      <view wx:else class="login-prompt">
        <text class="prompt-text">ç™»å½•åæŸ¥çœ‹ä¸ªäººæ•°æ®</text>
        <button class="login-btn-prompt" bindtap="goToLogin">
          <text class="btn-text">ç«‹å³ç™»å½•</text>
          <text class="btn-arrow">â†’</text>
        </button>
      </view>
    </view>
    <button wx:if="{{isLogin}}" class="edit-btn" type="default" bindtap="editProfile">
      <image src="/images/edit.png"></image>
      <text>ç¼–è¾‘èµ„æ–™</text>
    </button>
    <view wx:else class="empty-space"></view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view wx:if="{{isLogin}}" class="menu-section">
    <view class="menu-item" bindtap="goToMyActivities">
      <view class="menu-icon">
        <image src="/images/my-activities.png"></image>
      </view>
      <text class="menu-text">æˆ‘çš„æ´»åŠ¨</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="goToFavorites">
      <view class="menu-icon">
        <image src="/images/favorites.png"></image>
      </view>
      <text class="menu-text">æ”¶è—</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="goToReviews">
      <view class="menu-icon">
        <image src="/images/reviews.png"></image>
      </view>
      <text class="menu-text">è¯„ä»·</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="goToWallet">
      <view class="menu-icon">
        <image src="/images/wallet.png"></image>
      </view>
      <text class="menu-text">é’±åŒ…</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <!-- ç”³è¯·å•†å®¶æŒ‰é’®ï¼Œä»…æ™®é€šç”¨æˆ·å¯è§ -->
    <view wx:if="{{userRole === 'user'}}" class="menu-item" bindtap="applyForMerchant">
      <view class="menu-icon">
        <image src="/images/merchant-apply.png"></image>
      </view>
      <text class="menu-text">ç”³è¯·å•†å®¶</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <!-- å•†å®¶ç®¡ç†æŒ‰é’®ï¼Œä»…å•†å®¶å¯è§ -->
    <view wx:if="{{userRole === 'merchant'}}" class="menu-item" bindtap="goToMerchantManage">
      <view class="menu-icon">
        <image src="/images/merchant-manage.png"></image>
      </view>
      <text class="menu-text">å•†å®¶ç®¡ç†</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <!-- å•†å®¶å®¡æ ¸æŒ‰é’®ï¼Œä»…ç®¡ç†å‘˜å¯è§ -->
    <view wx:if="{{userRole === 'admin'}}" class="menu-item" bindtap="goToMerchantReview">
      <view class="menu-icon">
        <image src="/images/admin-review.png"></image>
      </view>
      <text class="menu-text">å•†å®¶å®¡æ ¸</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
  </view>

  <view class="menu-section">
    <view class="menu-item" bindtap="goToSettings">
      <view class="menu-icon">
        <image src="/images/settings.png"></image>
      </view>
      <text class="menu-text">è®¾ç½®</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="goToHelp">
      <view class="menu-icon">
        <image src="/images/help.png"></image>
      </view>
      <text class="menu-text">å¸®åŠ©ä¸­å¿ƒ</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="goToFeedback">
      <view class="menu-icon">
        <image src="/images/feedback.png"></image>
      </view>
      <text class="menu-text">æ„è§åé¦ˆ</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
    <view class="menu-item" bindtap="aboutUs">
      <view class="menu-icon">
        <image src="/images/about.png"></image>
      </view>
      <text class="menu-text">å…³äºæˆ‘ä»¬</text>
      <image class="menu-arrow" src="/images/arrow-right.png"></image>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
  <button wx:if="{{isLogin}}" class="logout-btn" type="default" bindtap="logout">
    é€€å‡ºç™»å½•
  </button>
</view>